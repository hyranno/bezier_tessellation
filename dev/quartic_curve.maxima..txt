load("vect")$

normalize(v) := v / sqrt(v.v)$

/* Quartic Bezier Curve */
t1 : 1-t0$
p :
  +v0 *t0^4
  +C1 *t0^3* t1^1
  +C2 *t0^2 *t1^2
  +C3 *t0^1 *t1^3
  +v1 *t1^4
$

dp_dt : diff(p, t0);

eqns : [
  ev(dp_dt, t0=1).n0 = 0,
  ev(dp_dt, t0=0).n1 = 0,
  ev(dp_dt, t0=0.5).(n0+n1) = 0
];
/*
(C1-4*v0).n0 = 0
(C3-4*v1).n1 = 0
((C1-C3)-2*(v1-v0))â‹…(n1+n0)=0
*/
C1 : 4*v0 + K*((v1-v0)-n0*(v1-v0).n0) $
C3 : 4*v1 + K*((v0-v1)-n1*(v0-v1).n1) $

C2 : (v0+v1)/2 + Kc*((C1/4-v0) + (C3/4-v1))$

K : 1$
Kc : 1/4$
